# vim: syntax=tmux

# changes the default Ctrl-b to Ctrl-z
unbind C-b
set -g prefix C-z
bind z send-prefix

bind-key k kill-window
bind-key -n M-C-h prev
bind-key -n M-C-l next

set -g base-index 1
set -g pane-base-index 1

set -s escape-time 0

bind | split-window -h
bind - split-window -v

bind-key -r M-Up resize-pane -U
bind-key -r M-Down resize-pane -D
bind-key -r M-Left resize-pane -L
bind-key -r M-Right resize-pane -R

setw -g aggressive-resize on

# Some tweaks to the status line
set -g status-right "%Y-%m-%d %H:%M:%S"
#set -g window-status-current-attr "underscore"
set -g status-interval 1

#set -g display-time 3000
set -g history-limit 100000

# No bells at all
set -g bell-action none
#set -g visual-activity off
#set -g visual-bell on

# Keep windows around after they exit
#set -g remain-on-exit on

# reload config
bind r source-file ~/.tmux.conf \; display-message "Config reloaded..."

set -g set-titles on
set-window-option -g automatic-rename on
set-window-option -g alternate-screen on
set-window-option -g clock-mode-style 24

#set -g default-terminal "screen-256color"
set -g default-terminal "xterm-256color"
#set-option -g default-shell /bin/bash

#set -ga terminal-overrides ',*:Ss=\E[%p1%d q:Se=\E[2 q'


# Turn the mouse on, but without copy mode dragging
set -g mouse on
unbind -n MouseDrag1Pane
unbind -Tcopy-mode MouseDrag1Pane

# ALT n/p next and previous window
bind -n M-n select-window -n
bind -n M-p select-window -p

# ALT 0-9 select window
bind -n M-0 select-window -t 0
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9

# alternively CTRL+0-9
# bind -n C-0 select-window -t 0
# bind-key -n C-1 select-window -t 1
# bind-key -n C-2 select-window -t 2
# bind -n C-3 select-window -t 3
# bind -n C-4 select-window -t 4
# bind -n C-5 select-window -t 5
# bind -n C-6 select-window -t 6
# bind -n C-7 select-window -t 7
# bind -n C-8 select-window -t 8
# bind -n C-9 select-window -t 9

# Some extra key bindings to select higher numbered windows
# bind F1 selectw -t:10
# bind F2 selectw -t:11
# bind F3 selectw -t:12
# bind F4 selectw -t:13
# bind F5 selectw -t:14
# bind F6 selectw -t:15
# bind F7 selectw -t:16
# bind F8 selectw -t:17
# bind F9 selectw -t:18
# bind F10 selectw -t:19
# bind F11 selectw -t:20
# bind F12 selectw -t:21

# Keys to toggle monitoring activity in a window, and synchronize-panes
#bind m set monitor-activity
#bind y set synchronize-panes\; display 'synchronize-panes #{?synchronize-panes,on,off}'

# Create a single default session, because a session is created here, tmux
# should be started with "tmux attach" rather than "tmux new"
#new -d -s0 -nirssi 'exec irssi'
#set -t0:0 monitor-activity on
#set  -t0:0 aggressive-resize on
#neww -d -ntodo 'exec emacs ~/TODO'
#setw -t0:1 aggressive-resize on
#neww -d -nmutt 'exec mutt'
#setw -t0:2 aggressive-resize on
#neww -d
#neww -d
#neww -d

# default colors
#set -g status-bg black
#set -g status-fg white
#set -g status-bg white
#set -g status-fg black

# Turn the mouse on, but without copy mode dragging
set -g mouse on
unbind -n MouseDrag1Pane
unbind -Tcopy-mode MouseDrag1Pane

# Smart pane switching with awareness of Vim splits.
# See: https://github.com/christoomey/vim-tmux-navigator
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|l?n?vim?x?|fzf)(diff)?$'"
bind-key -n 'C-h' if-shell "$is_vim" 'send-keys C-h'  'select-pane -L'
bind-key -n 'C-j' if-shell "$is_vim" 'send-keys C-j'  'select-pane -D'
bind-key -n 'C-k' if-shell "$is_vim" 'send-keys C-k'  'select-pane -U'
bind-key -n 'C-l' if-shell "$is_vim" 'send-keys C-l'  'select-pane -R'
tmux_version='$(tmux -V | sed -En "s/^tmux ([0-9]+(.[0-9]+)?).*/\1/p")'
if-shell -b '[ "$(echo "$tmux_version < 3.0" | bc)" = 1 ]' \
    "bind-key -n 'C-\\' if-shell \"$is_vim\" 'send-keys C-\\'  'select-pane -l'"
if-shell -b '[ "$(echo "$tmux_version >= 3.0" | bc)" = 1 ]' \
    "bind-key -n 'C-\\' if-shell \"$is_vim\" 'send-keys C-\\\\'  'select-pane -l'"

# vi for copy mode
setw -g mode-keys vi

bind-key -T copy-mode-vi 'C-h' select-pane -L
bind-key -T copy-mode-vi 'C-j' select-pane -D
bind-key -T copy-mode-vi 'C-k' select-pane -U
bind-key -T copy-mode-vi 'C-l' select-pane -R
bind-key -T copy-mode-vi 'C-\' select-pane -l

# bind additional arrow keys
bind-key -n 'C-Left' if-shell "$is_vim" 'send-keys C-h'  'select-pane -L'
bind-key -n 'C-Down' if-shell "$is_vim" 'send-keys C-j'  'select-pane -D'
bind-key -n 'C-Up' if-shell "$is_vim" 'send-keys C-k'  'select-pane -U'
bind-key -n 'C-Right' if-shell "$is_vim" 'send-keys C-l'  'select-pane -R'

bind-key -T copy-mode-vi 'C-Left' select-pane -L
bind-key -T copy-mode-vi 'C-Down' select-pane -D
bind-key -T copy-mode-vi 'C-Up' select-pane -U
bind-key -T copy-mode-vi 'C-Right' select-pane -R

# default inactive/active window styles
set -g window-style fg=default,bg=default
set -g window-active-style fg=default,bg=default

source ~/.tmux.conf.colors
